wip. and yeah the architecture here sucks